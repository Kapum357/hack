<!DOCTYPE html>

<html class="dark" lang="es"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Community Reporting Platform</title>
<link rel="stylesheet" href="styles.css" />
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;500;600;700;800&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display">
<div class="relative flex h-auto min-h-screen w-full flex-col group/design-root overflow-x-hidden">
<div class="layout-container flex h-full grow flex-col">
<header class="flex items-center justify-between whitespace-nowrap border-b border-solid border-white/10 px-6 sm:px-10 lg:px-20 py-3 bg-background-light dark:bg-background-dark/80 backdrop-blur-sm sticky top-0 z-10">
<div class="flex items-center gap-4 text-black dark:text-white">
<div class="size-6 text-primary">
<svg fill="currentColor" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
<path d="M24 45.8096C19.6865 45.8096 15.4698 44.5305 11.8832 42.134C8.29667 39.7376 5.50128 36.3314 3.85056 32.3462C2.19985 28.361 1.76794 23.9758 2.60947 19.7452C3.451 15.5145 5.52816 11.6284 8.57829 8.5783C11.6284 5.52817 15.5145 3.45101 19.7452 2.60948C23.9758 1.76795 28.361 2.19986 32.3462 3.85057C36.3314 5.50129 39.7376 8.29668 42.134 11.8833C44.5305 15.4698 45.8096 19.6865 45.8096 24L24 24L24 45.8096Z"></path>
</svg>
</div>
<h2 class="text-black dark:text-white text-lg font-bold leading-tight tracking-[-0.015em]">Resilience Soacha</h2>
</div>
<div class="flex flex-1 justify-end items-center gap-4 md:gap-8">
<nav class="hidden md:flex items-center gap-6">
<a class="text-black/80 dark:text-white/80 hover:text-black dark:hover:text-white text-sm font-medium leading-normal transition-colors" href="#">Dashboard</a>
<a class="text-black dark:text-white text-sm font-bold leading-normal" href="#">Submit Report</a>
</nav>
<div class="flex items-center gap-2">
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 w-10 bg-black/5 dark:bg-white/5 text-black/60 dark:text-white/60 hover:bg-black/10 dark:hover:bg-white/10 transition-colors">
<span class="material-symbols-outlined text-xl">notifications</span>
</button>
<button class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-full h-10 w-10 bg-black/5 dark:bg-white/5 text-black/60 dark:text-white/60 hover:bg-black/10 dark:hover:bg-white/10 transition-colors">
<span class="material-symbols-outlined text-xl">help</span>
</button>
</div>
<div class="bg-center bg-no-repeat aspect-square bg-cover rounded-full size-10" data-alt="User profile picture" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuCX_uJ4k6-OvBwhBWj4Z3Nn14ygA_Pqw_xWbv__AQ5YN5g3IghggR-SSjngrWgqaj6CNhJ6LFVF5HmH3Fs1tkggpgSnLc6k6fXP1C6q7aH1W_t2I_yEgjOMIeR-3Zetji0-u15Lf2xtQJ6x5HwMteyrHXOEx_H7bk0Hbl-TOg3kACTV_h4RN-ch5rsj51l1wBuHLVOA6CTPiVPGO9z3K2NjIKLOg2s8OHRLBUJ6X3wJhKmD9UfBu1tulsWJgdRyRkWLOKFhmN0sKFM");'></div>
</div>
</header>
<main class="flex-1 w-full max-w-screen-2xl mx-auto p-4 md:p-6 lg:p-8">
<div class="flex flex-col gap-6">
<div class="flex flex-wrap justify-between items-start gap-3">
<div class="flex min-w-72 flex-col gap-2">
<h1 class="text-black dark:text-white text-3xl md:text-4xl font-black leading-tight tracking-[-0.033em]">Enviar un Nuevo Reporte Comunitario</h1>
<p class="text-black/60 dark:text-white/60 text-base font-normal leading-normal">Haga clic en el mapa para establecer la ubicación o complete los detalles a continuación.</p>
</div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 items-start">
<div id="map" class="w-full rounded-xl h-full min-h-[400px] lg:min-h-[700px] sticky top-24"></div>
<div class="flex flex-col gap-6">
<div class="bg-background-light dark:bg-black/20 border border-black/10 dark:border-white/10 p-6 rounded-xl">
<h2 class="text-black dark:text-white text-xl font-bold leading-tight tracking-[-0.015em] mb-6">Detalles del Reporte</h2>
<form class="flex flex-col gap-6">
<div class="flex flex-col">
<label class="text-black dark:text-white text-sm font-medium leading-normal pb-2" for="event-type">Tipo de Evento/Incidente</label>
<select class="form-select w-full min-w-0 resize-none overflow-hidden rounded-lg text-black dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-black/20 dark:border-white/20 bg-background-light dark:bg-background-dark/50 focus:border-primary/50 h-12 placeholder:text-black/40 dark:placeholder:text-white/40 px-3 text-base font-normal leading-normal" id="event-type">
<option>Seleccione un tipo de evento</option>
<option>Inundación</option>
<option>Deslizamiento de tierra</option>
<option>Daño a la infraestructura</option>
<option>Necesidad de la comunidad</option>
</select>
</div>
<div class="flex flex-col">
<label class="text-black dark:text-white text-sm font-medium leading-normal pb-2" for="event-date">Fecha y Hora</label>
<input class="form-input w-full min-w-0 resize-none overflow-hidden rounded-lg text-black dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-black/20 dark:border-white/20 bg-background-light dark:bg-background-dark/50 focus:border-primary/50 h-12 placeholder:text-black/40 dark:placeholder:text-white/40 px-3 text-base font-normal leading-normal" id="event-date" type="datetime-local"/>
</div>
<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
<div class="flex flex-col">
<label class="text-black dark:text-white text-sm font-medium leading-normal pb-2" for="latitude">Latitud</label>
<input class="form-input w-full min-w-0 resize-none overflow-hidden rounded-lg text-black/70 dark:text-white/70 focus:outline-0 border border-black/20 dark:border-white/20 bg-black/5 dark:bg-white/5 h-12 px-3 text-base font-normal leading-normal cursor-not-allowed" id="latitude" placeholder="4.5828" readonly="" type="text"/>
</div>
<div class="flex flex-col">
<label class="text-black dark:text-white text-sm font-medium leading-normal pb-2" for="longitude">Longitud</label>
<input class="form-input w-full min-w-0 resize-none overflow-hidden rounded-lg text-black/70 dark:text-white/70 focus:outline-0 border border-black/20 dark:border-white/20 bg-black/5 dark:bg-white/5 h-12 px-3 text-base font-normal leading-normal cursor-not-allowed" id="longitude" placeholder="-74.2120" readonly="" type="text"/>
</div>
</div>
<div class="flex flex-col">
<label class="text-black dark:text-white text-sm font-medium leading-normal pb-2">Cargar Foto/Video</label>
<div class="flex items-center justify-center w-full">
<label class="flex flex-col items-center justify-center w-full h-40 border-2 border-black/20 dark:border-white/20 border-dashed rounded-lg cursor-pointer bg-background-light dark:bg-background-dark/50 hover:bg-black/5 dark:hover:bg-white/5 transition-colors" for="dropzone-file">
<div class="flex flex-col items-center justify-center pt-5 pb-6">
<span class="material-symbols-outlined text-4xl text-black/50 dark:text-white/50 mb-2">cloud_upload</span>
<p class="mb-2 text-sm text-black/60 dark:text-white/60"><span class="font-semibold">Haga clic para cargar</span> o arrastre y suelte</p>
<p class="text-xs text-black/50 dark:text-white/50">SVG, PNG, JPG o GIF (MAX. 10MB)</p>
</div>
<input class="hidden" id="dropzone-file" type="file"/>
</label>
</div>
</div>
<div class="flex flex-col">
<label class="text-black dark:text-white text-sm font-medium leading-normal pb-2" for="description">Describa la Situación</label>
<textarea class="form-textarea w-full min-w-0 resize-y overflow-hidden rounded-lg text-black dark:text-white focus:outline-0 focus:ring-2 focus:ring-primary/50 border border-black/20 dark:border-white/20 bg-background-light dark:bg-background-dark/50 focus:border-primary/50 placeholder:text-black/40 dark:placeholder:text-white/40 p-3 text-base font-normal leading-normal" id="description" placeholder="Añada notas cualitativas aquí..." rows="4"></textarea>
</div>
<button class="flex w-full cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-primary text-black gap-2 text-base font-bold leading-normal tracking-[0.015em] px-6 hover:brightness-90 transition-all" type="submit">Enviar Reporte</button>
</form>
</div>
</div>
</div>
</div>
</main>
</div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize map
    const map = L.map('map').setView([4.58, -74.21], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© OpenStreetMap contributors'
    }).addTo(map);

    let marker;

    // Click on map to set location
    map.on('click', function(e) {
        const { lat, lng } = e.latlng;
        document.getElementById('latitude').value = lat.toFixed(4);
        document.getElementById('longitude').value = lng.toFixed(4);

        if (marker) {
            map.removeLayer(marker);
        }
        marker = L.marker([lat, lng]).addTo(map);
    });

    // Set default date
    document.getElementById('event-date').value = new Date().toISOString().slice(0, 16);

    // File upload handling
    const dropzone = document.getElementById('dropzone-file');
    const fileLabel = dropzone.parentElement;
    let selectedFiles = [];

    dropzone.addEventListener('change', function(e) {
        selectedFiles = Array.from(e.target.files);
        updateFilePreview();
    });

    // Drag and drop
    fileLabel.addEventListener('dragover', function(e) {
        e.preventDefault();
        fileLabel.classList.add('bg-black/10', 'dark:bg-white/10');
    });

    fileLabel.addEventListener('dragleave', function(e) {
        e.preventDefault();
        fileLabel.classList.remove('bg-black/10', 'dark:bg-white/10');
    });

    fileLabel.addEventListener('drop', function(e) {
        e.preventDefault();
        fileLabel.classList.remove('bg-black/10', 'dark:bg-white/10');
        selectedFiles = Array.from(e.dataTransfer.files);
        // Simulate setting files to input
        dropzone.files = e.dataTransfer.files;
        updateFilePreview();
    });

    function updateFilePreview() {
        const previewDiv = document.createElement('div');
        previewDiv.id = 'file-preview';
        previewDiv.className = 'mt-4 space-y-2';

        selectedFiles.forEach((file, index) => {
            if (file.size > 10 * 1024 * 1024) {
                alert(`Archivo ${file.name} es demasiado grande. Máximo 10MB.`);
                selectedFiles.splice(index, 1);
                return;
            }
            const fileItem = document.createElement('div');
            fileItem.className = 'flex items-center gap-2 p-2 bg-black/5 dark:bg-white/5 rounded';
            fileItem.innerHTML = `
                <span class="material-symbols-outlined text-sm">attach_file</span>
                <span class="text-sm">${file.name}</span>
                <span class="text-xs text-black/50 dark:text-white/50">(${(file.size / 1024 / 1024).toFixed(2)} MB)</span>
            `;
            previewDiv.appendChild(fileItem);
        });

        // Remove old preview
        const oldPreview = document.getElementById('file-preview');
        if (oldPreview) oldPreview.remove();

        fileLabel.parentElement.appendChild(previewDiv);
    }

    // Form submission
    const form = document.querySelector('form');
    form.addEventListener('submit', function(e) {
        e.preventDefault();

        const formData = new FormData(this);
        const report = {
            eventType: formData.get('event-type'),
            dateTime: formData.get('event-date'),
            latitude: document.getElementById('latitude').value,
            longitude: document.getElementById('longitude').value,
            description: formData.get('description'),
            files: selectedFiles.map(file => ({
                name: file.name,
                size: file.size,
                type: file.type
            })),
            id: Date.now(),
            timestamp: new Date().toISOString()
        };

        // Validation
        if (!report.eventType || report.eventType === 'Seleccione un tipo de evento') {
            showMessage('Por favor seleccione un tipo de evento.', 'error');
            return;
        }
        if (!report.dateTime) {
            showMessage('Por favor seleccione fecha y hora.', 'error');
            return;
        }
        if (!report.latitude || !report.longitude) {
            showMessage('Por favor haga clic en el mapa para seleccionar la ubicación.', 'error');
            return;
        }
        if (!report.description.trim()) {
            showMessage('Por favor describa la situación.', 'error');
            return;
        }

        // Save to localStorage (simulate backend)
        const reports = JSON.parse(localStorage.getItem('communityReports') || '[]');
        reports.push(report);
        localStorage.setItem('communityReports', JSON.stringify(reports));

        showMessage('Reporte enviado exitosamente. Gracias por su contribución.', 'success');

        // Reset form
        form.reset();
        document.getElementById('latitude').value = '';
        document.getElementById('longitude').value = '';
        if (marker) map.removeLayer(marker);
        selectedFiles = [];
        const preview = document.getElementById('file-preview');
        if (preview) preview.remove();
        document.getElementById('event-date').value = new Date().toISOString().slice(0, 16);
    });

    function showMessage(message, type) {
        const msgDiv = document.createElement('div');
        msgDiv.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${type === 'success' ? 'bg-green-600' : 'bg-red-600'} text-white`;
        msgDiv.textContent = message;
        document.body.appendChild(msgDiv);
        setTimeout(() => msgDiv.remove(), 5000);
    }
});
</script>
</body></html>
